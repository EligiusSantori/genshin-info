<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Artifacts enchantment helper</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap-reboot.min.css" integrity="sha256-fjdlYyQyUwnf7m25DM18I325nnS2LbN7gdHPrq+OCyc=" crossorigin="anonymous" />
	<link rel="stylesheet" href="css/enchant.css" />
	<script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/mathjs@14.6.0/lib/browser/math.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/ractive@1.4.4/ractive.min.js"></script>
	<script src="js/formula.js"></script>
	<script defer src="js/index.js"></script>
	<script defer src="js/ruleset.js"></script>
	<script defer src="js/ruleset/default.js"></script>
	<script defer src="js/enchant.js"></script>
</head>
<body>
	<div id="content"></div>
	<script id="layout" type="text/ractive">
		<nav>
			<section class="sets radio-panel">
			{{#each sets: i}}
				<label class="radio-image"><input type="radio" name="{{artifact.set}}" value="{{name}}" /><img src="{{image}}" alt="{{name}}" /></label>
				{{#if i == sets.length / 2 - 1}}<div  class="flex-break"></div>{{/if}}
			{{/each}}
			</section>

		</nav>
		<hr class="flex-break" />
		<aside class="summary">
		{{#if !@global._.isEmpty(summary)}}
			<table>
				<tr><th colspan="2">Summary</th></tr>
				{{#with summary.rolls}}<tr><th>Rolls</th><td>{{.}}</td></tr>{{/with}}
				{{#with summary.rules}}<tr><th>Rules</th><td>{{.}}</td></tr>{{/with}}
				{{#with summary.forecasts}}<tr><th>Variants</th><td>{{.}}</td></tr>{{/with}}
			</table>
		{{/if}}
		</aside>
		<article>
			<table id="artifact" class="verdict-{{ @this.verdictAsClass(verdict, 'error', 'unclaimed', 'promising') }}">
				<tr class="level-row">
					<th colspan="3">Level<span class="note" tooltip="For 3-stat artifacts use level ‚â• 4 since v6.0">ùê¢</span></th>
					<td>{{artifact.level}}</td>
					<td colspan="2"><input type="range" min="0" max="20" step="4" value="{{artifact.level}}" /></td>
				</tr>
				<tr class="column-row">
					<td rowspan="9">
						<div class="radio-panel">
							<label class="radio-icon"><input type="radio" name="{{artifact.slot}}" value="0" />
								<img alt="Flower" src="images/Icon_Flower_of_Life.png" /><br /></label>
							<label class="radio-icon"><input type="radio" name="{{artifact.slot}}" value="1" />
								<img alt="Plume" src="images/Icon_Plume_of_Death.png" /></label>
							<label class="radio-icon"><input type="radio" name="{{artifact.slot}}" value="2" />
								<img alt="Sands" src="images/Icon_Sands_of_Eon.png" /></label>
							<label class="radio-icon"><input type="radio" name="{{artifact.slot}}" value="3" />
								<img alt="Goblet" src="images/Icon_Goblet_of_Eonothem.png" /></label>
							<label class="radio-icon"><input type="radio" name="{{artifact.slot}}" value="4" />
								<img alt="Circlet" src="images/Icon_Circlet_of_Logos.png" /></label>
						</div>
					</td>
					<td rowspan="9">
						<div class="radio-panel">
						{{#each affixes: name}}
							<label class="radio-pane"><input type="radio" name="{{artifact.affix}}" value="{{name}}" />{{ . }}</label>
						{{/each}}
						</div>
					</td>
				</tr>
				{{#each stats: name}}
				<tr class="stat-row {{name == artifact.affix && 'disabled'}}">
					<th>{{title}}</th>
					<td><input type="number" min="{{min}}" max="{{max}}" step="{{step}}" value="{{artifact[name]}}"
						disabled="{{name == artifact.affix}}" /></td>
					<td><input type="range" min="{{min}}" max="{{max}}" step="{{step}}" value="{{artifact[name] || 0}}"
						disabled="{{name == artifact.affix}}" twoway="0" on-input="['statChange', name]" /></td>
					{{#unless name == 'def' || name == 'hp'}}
					<td class="coeff" rowspan="{{ name == 'atk' ? 3 : 1 }}">√ó{{ @this.fraction(coeffs[name] || coeffs.bd) }}</td>
					{{/unless}}
				</tr>
				{{/each}}
				<tr class="quality-row">
					<th colspan="2">Quality</th>
					<td colspan="2"><button tabindex="-1" on-click="@this.clear()">{{{ @this.decimal(quality) || '&nbsp;' }}}</button></td>
				</tr>
			</table>
		</article>
		<aside class="display">
			<table class="messages">
			{{#if artifact && messages.length > 0}}
				<tr>
					<th></th>
				{{#each @this.filled(4)}}
					<td>{{.}}</td>
				{{/each}}
				</tr>
			{{/if}}
			{{#each messages}}
				<tr class="{{type}}">
					<th colspan="{{type == 'error' ? 5 : 1}}">
						{{{text}}}
						{{#with formula}}<span class="note" tooltip="{{.}}">ùê¢</span>{{/with}}
					</th>
				{{#each artifact ? artifact.toDisplay() : []}}
					<td>{{.}}</td>
				{{/each}}
				</tr>
			{{/each}}
			</table>
		</aside>
		{{#if @this.constructor.DEBUG}}
		<samp class="debug" style="bottom: var(--doc-margin-h); right: var(--doc-margin-w);">{{ JSON.stringify(artifact.valid()) }}</samp>
		<ol class="debug todo">
			<li>–ü—Ä–∞–≤–∏–ª–∞: BD circlets</li>
			<li>–ü—Ä–∞–≤–∏–ª–∞: shared ATK/ER/EM/CR sets rules</li>
			<li>–ü—Ä–∞–≤–∏–ª–∞: non-combat rules</li>
			<li>–î–æ–±–∞–≤–∏—Ç—å —Ç–æ—á–Ω—ã–µ affixes –¥–ª—è goblets.</li>
			<li>–ü—Ä–∞–≤–∏–ª–∞: in-set goblets &lt;- ED..., PD, BD</li>
			<li>–ü—Ä–∞–≤–∏–ª–∞: in-set healing circlets</li>
			<li>–ü—Ä–∞–≤–∏–ª–∞: –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏–∑ –ø—Ä–∞–≤–∏–ª</li>
			<li>–î–æ–±–∞–≤–∏—Ç—å —Ç–æ—á–Ω—ã–µ coeffs –¥–ª—è sets (–Ω—É–∂–µ–Ω –æ–±—ä–µ–∫—Ç Coeffs)? –¢–æ–≥–¥–∞ bd —É–¥–∞–ª—è–µ–º, –Ω–æ –æ—Ç —á–µ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å CR –∏ EM –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞–±–æ—Ä–∞—Ö?</li>
			<li>–ü—Ä–∞–≤–∏–ª–∞: Q >= 40 for non-mandatory hp & def flowers/plumes?</li>
			<li>–ü—Ä–∞–≤–∏–ª–∞ Q: ATK > HP > DEF –¥–ª—è sands –≤ –æ–±—ã—á–Ω—ã—Ö –Ω–∞–±–æ—Ä–∞—Ö?</li>

			<li>–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π –≤ local storage (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ ractivejs)</li>
			<li>–û–ø—Ü–∏–∏: 1. –ø—Ä–∏–º–µ—Ä–Ω—ã–µ/—Ç–æ—á–Ω—ã–µ —Å–ª–∞–π–¥–µ—Ä—ã; 2. –≤–∫–ª—é—á–µ–Ω–∏–µ –∏ –≤—ã–∫–ª—é—á–µ–Ω–∏–µ local storage;</li>
			<li>–î–æ–±–∞–≤–∏—Ç—å –∫—Ä–∞—Å–∏–≤—É—é background-–∞–Ω–∏–º–∞—Ü–∏—é (–ª—É—á—à–µ –≤ —Å—Ç–∏–ª–µ Genshin), —Å–¥–µ–ª–∞—Ç—å –∫—Ä–∞—Å–∏–≤—ã–µ —Å–ª–∞–π–¥–µ—Ä—ã+—Ä–∏—Å–∫–∏ –∏ –∞–Ω–∏–º–∞—Ü–∏–∏ –∫ tooltip.</li>

			<li>–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–æ–ª–∑—É–Ω–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–æ–ª–∂–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å –∏ —Ç–∞–∫-–∂–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –¥–æ–ª–∂–Ω–æ —Å—Ä–µ–∑–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã?</li>
			<li>–ü–æ–¥—Å–≤–µ—á–∏–≤–∞—Ç—å –∫—Ä–∞—Å–Ω—ã–º —É—Ä–æ–≤–µ–Ω—å, –µ—Å–ª–∏ –æ–Ω –Ω–µ —Å—Ö–æ–¥–∏—Ç—Å—è —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ—Ä–µ–∞–ª—å–Ω–æ–µ.</li>
			<li>OCR –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (—É–¥–æ–±–Ω–µ–µ) –∏–ª–∏ —Å clipboard (–±–µ–∑–æ–ø–∞—Å–Ω–µ–µ)?</li>
			<li>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã: –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –Ω—É–∂–µ–Ω –Ω–∞–±–æ—Ä—É, –º–æ–∂–µ—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è –∏ –Ω—É–∂–µ–Ω –≤ off-set?</li>
			<li>–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ Q –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ?</li>
			<li>–û—Ç–æ–±—Ä–∞–∂–∞—Ç—å 3 –∏–ª–∏ 4 —Å—Ç–∞—Ç–æ–≤—ã–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –≤ summary?</li>
			<li>–ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –Ω–∞ –º–æ–¥—É–ª–∏ (https://www.w3schools.com/js/js_modules.asp)</li>
			<li>–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É–ª—É —Ä–∞—Å—á—ë—Ç–∞ –æ—Å–Ω–æ–≤–Ω–æ–π quality –≤ tooltip.</li>
			<li>input range value debounce?</li>
		</ol>
		{{/if}}
	</script>
	<script type="text/javascript">
		//Ractive.DEBUG = /unminified/.test(function(){/*unminified*/})
		Ractive.DEBUG = window.location.protocol.startsWith('file:');
		window.onload = function() { ready('#content', '#layout'); }
	</script>
</body>
</html>
